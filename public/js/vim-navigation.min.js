class VimNavigation{constructor(){this.mode="normal",this.commandBuffer="",this.links=[],this.paragraphs=[],this.currentLinkIndex=-1,this.currentParagraphIndex=-1,this.modeIndicator=null,this.titleCursor=null,this.isInPostContent=!1,this.isHomePage=document.querySelector(".profile")!==null,this.init()}init(){this.createModeIndicator(),this.titleCursor=document.querySelector(".site-title .vim-cursor"),this.titleCursor&&this.titleCursor.textContent==="â–ˆ"&&(this.titleCursor.textContent="|"),this.isInPostContent=document.querySelector(".post-content")!==null,this.updateLinksList(),this.isInPostContent&&this.updateParagraphsList(),this.isHomePage||this.focusOnTitleLink(),document.addEventListener("keydown",this.handleKeyPress.bind(this))}focusOnTitleLink(){const e=document.querySelector(".breadcrumbs a");e&&(this.currentLinkIndex=this.links.indexOf(e),this.highlightCurrentElement())}createModeIndicator(){this.modeIndicator=document.createElement("div"),this.modeIndicator.style.cssText=`
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--theme);
            color: var(--primary);
            padding: 5px 10px;
            border-radius: 4px;
            font-family: monospace;
            z-index: 1000;
            border: 1px solid var(--border);
        `,this.updateModeIndicator(),document.body.appendChild(this.modeIndicator)}updateModeIndicator(){this.modeIndicator.textContent=`-- ${this.mode.toUpperCase()} --`}updateLinksList(){const e=Array.from(document.querySelectorAll("a")).filter(e=>{const t=e.closest(".site-title"),n=e.closest(".post-content"),s=e.closest(".logo");return!t&&!n&&!s});this.links=e.sort((e,t)=>{const n=e.closest(".breadcrumbs")!==null,s=t.closest(".breadcrumbs")!==null;return n&&!s?-1:!n&&s?1:n&&s?Array.from(document.querySelectorAll(".breadcrumbs a")).indexOf(e)-Array.from(document.querySelectorAll(".breadcrumbs a")).indexOf(t):0}),this.currentLinkIndex=-1}updateParagraphsList(){const e=document.querySelector(".post-content");if(e){const t=[];t.push(...Array.from(e.querySelectorAll("p, h1, h2, h3, h4, h5, h6, blockquote, pre")));const n=Array.from(e.querySelectorAll("li")).filter(e=>{const n=e.parentElement,t=n.parentElement;return!t||!t.closest("li")});t.push(...n),this.paragraphs=t.filter(e=>{const t=e.textContent.trim(),n=e.querySelector("img")!==null;return t.length>0||n})}}highlightCurrentElement(){document.querySelectorAll(".nav-cursor").forEach(e=>e.remove()),document.querySelectorAll(".nav-selected").forEach(e=>e.classList.remove("nav-selected")),this.titleCursor&&(this.titleCursor.style.display="none");let e=null;if(this.isInPostContent&&this.currentParagraphIndex>=0?e=this.paragraphs[this.currentParagraphIndex]:this.currentLinkIndex>=0&&this.currentLinkIndex<this.links.length&&(e=this.links[this.currentLinkIndex]),e){if(e.closest(".footer")||e.closest(".post-entry")||e.closest(".breadcrumbs"))e.closest(".post-entry")?e.closest(".post-entry").classList.add("nav-selected"):e.classList.add("nav-selected");else{const t=document.createElement("span");t.className="nav-cursor",t.textContent="|",e.appendChild(t)}e.scrollIntoView({behavior:"smooth",block:"center"})}else this.titleCursor&&(this.titleCursor.style.display="")}handleKeyPress(e){if(e.key==="G"&&!e.shiftKey)return;if(e.target.tagName.toLowerCase()==="input"||e.target.tagName.toLowerCase()==="textarea")return;if(["j","k","g","G","Enter","Escape"].includes(e.key)&&e.preventDefault(),e.key==="Enter"){this.currentLinkIndex>=0&&this.currentLinkIndex<this.links.length&&this.links[this.currentLinkIndex].click();return}if(e.key==="g"){this.commandBuffer==="g"?(this.handleNormalMode("g"),this.commandBuffer=""):(this.commandBuffer="g",setTimeout(()=>{this.commandBuffer=""},500));return}if(this.commandBuffer="",this.mode==="normal"){const t=e.key==="G"&&e.shiftKey?"G":e.key;this.handleNormalMode(t)}}handleNormalMode(e){if(this.isInPostContent){switch(e){case"j":if(this.currentLinkIndex>=0){const e=this.links[this.currentLinkIndex],t=e.closest(".breadcrumbs")!==null;t&&this.currentLinkIndex===this.links.filter(e=>e.closest(".breadcrumbs")).length-1?(this.currentLinkIndex=-1,this.currentParagraphIndex=0):this.currentLinkIndex<this.links.length-1&&this.currentLinkIndex++}else if(this.currentParagraphIndex===-1)this.currentParagraphIndex=0;else if(this.currentParagraphIndex<this.paragraphs.length-1)this.currentParagraphIndex++;else{const e=this.links.filter(e=>e.closest(".footer"));e.length>0&&(this.currentParagraphIndex=-1,this.currentLinkIndex=this.links.indexOf(e[0]))}this.highlightCurrentElement();break;case"k":if(this.currentLinkIndex>=0){const e=this.links[this.currentLinkIndex],t=e.closest(".footer")!==null;t&&this.currentLinkIndex===this.links.indexOf(this.links.filter(e=>e.closest(".footer"))[0])?(this.currentLinkIndex=-1,this.currentParagraphIndex=this.paragraphs.length-1):this.currentLinkIndex>0&&this.currentLinkIndex--}else if(this.currentParagraphIndex<=0){this.currentParagraphIndex=-1;const e=this.links.filter(e=>e.closest(".breadcrumbs"));e.length>0&&(this.currentLinkIndex=this.links.indexOf(e[e.length-1]))}else this.currentParagraphIndex--;this.highlightCurrentElement();break;case"g":this.currentParagraphIndex=-1,this.currentLinkIndex=0,this.highlightCurrentElement();break;case"G":const e=this.links.filter(e=>e.closest(".footer"));e.length>0?(this.currentParagraphIndex=-1,this.currentLinkIndex=this.links.indexOf(e[e.length-1])):(this.currentLinkIndex=-1,this.currentParagraphIndex=this.paragraphs.length-1),this.highlightCurrentElement();break;case"enter":this.currentLinkIndex>=0&&this.currentLinkIndex<this.links.length&&this.links[this.currentLinkIndex].click();break;case"escape":this.currentParagraphIndex=-1,this.currentLinkIndex=-1,this.highlightCurrentElement();break}return}switch(e){case"j":this.currentLinkIndex===-1?this.currentLinkIndex=0:this.currentLinkIndex=Math.min(this.currentLinkIndex+1,this.links.length-1),this.highlightCurrentElement();break;case"k":this.currentLinkIndex>0&&(this.currentLinkIndex=Math.max(this.currentLinkIndex-1,0),this.highlightCurrentElement());break;case"g":this.currentLinkIndex=0,this.highlightCurrentElement();break;case"G":this.currentLinkIndex=this.links.length-1,this.highlightCurrentElement();break;case"i":this.mode="insert",this.updateModeIndicator();break;case"/":break;case"escape":this.currentLinkIndex=-1,this.highlightCurrentElement();break}}}document.addEventListener("DOMContentLoaded",()=>{window.vimNav=new VimNavigation})